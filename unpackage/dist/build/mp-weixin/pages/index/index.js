"use strict";const t=require("../../common/vendor.js"),e=require("../../common/assets.js"),n={data:()=>({hello:"Hi",content:{content:"",timestamp:""},list:[]}),onLoad(){let e=t.index.getStorageSync("token");e?this.getList():t.index.login().then((({code:n})=>{t.Zs.callFunction({name:"fun",data:{api:"loginWithMap",code:n}}).then((({result:n})=>{e=n.token,t.index.setStorageSync("token",e),this.getList()}))}))},methods:{nav(e){t.index.navigateTo({url:e})},change(){this.$data.hello="欢迎来到YINCE的APP"},getList(e){t.Zs.callFunction({name:"fun",data:{api:e||"getMessages",token:t.index.getStorageSync("token")}}).then((t=>{this.list=t.result.data})).catch((e=>{t.index.showToast({icon:"error",title:"未登录"})}))},publish(){""===this.content.content||null===this.content.content?t.index.showToast({title:"请输入内容",icon:"error"}):t.Zs.callFunction({name:"fun",data:{api:"publish",content:this.content,token:t.index.getStorageSync("token")}}).then((e=>{console.log(e),this.content.content="",t.index.showToast({title:"留言成功",icon:"success"})}))}}};const o=t._export_sfc(n,[["render",function(n,o,i,s,a,c){return{a:e._imports_0,b:a.content.content,c:t.o((t=>a.content.content=t.detail.value)),d:t.o((t=>c.publish())),e:t.o((t=>c.getList("getMyMessages"))),f:t.f(a.list,((e,n,o)=>t.e({a:t.t(e.content.content),b:!e.public},(e.public,{}),{c:e._id}))),g:t.o((t=>c.nav("/pages/form/form"))),h:t.o((t=>c.nav("/pages/list/list"))),i:t.o((t=>c.nav("/pages/tip/tip"))),j:t.o((t=>c.nav("/pages/group/group")))}}]]);wx.createPage(o);
